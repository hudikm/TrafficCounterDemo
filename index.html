<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Tutorial created by Tutorial maker"><link href=https://hudikm.github.io/TrafficCounterDemo/ rel=canonical><meta name=author content="Martin HÃºdik"><link rel="shortcut icon" href=assets/favicon.png><meta name=generator content="mkdocs-1.1, mkdocs-material-5.1.5"><title>ViewModel: A Simple Example</title><link rel=stylesheet href=assets/stylesheets/main.df84b5fe.min.css><link rel=stylesheet href=assets/stylesheets/palette.8435c73a.min.css><meta name=theme-color content=#3f51b5><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style><link rel=stylesheet href=stylesheets/extra.css></head> <body dir=ltr data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#viewmodel-a-simple-example class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid" aria-label=Header> <a href=https://hudikm.github.io/TrafficCounterDemo/ title="ViewModel: A Simple Example" class="md-header-nav__button md-logo" aria-label="ViewModel: A Simple Example"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 89 89"><path d="M3.136 17.387v42.932l42.932 21.467L3.136 17.387z"/><path fill-opacity=.5 d="M21.91 8l42.933 64.398-18.775 9.388L3.136 17.387 21.91 8z"/><path d="M67.535 17.387L40.273 35.543l21.878 32.818 5.384 2.691V17.387z"/><path fill-opacity=.25 d="M67.535 17.387v53.666l18.774-9.388V8l-18.774 9.387z"/></svg> </a> <label class="md-header-nav__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header-nav__title data-md-component=header-title> <div class=md-header-nav__ellipsis> <span class="md-header-nav__topic md-ellipsis"> ViewModel: A Simple Example </span> <span class="md-header-nav__topic md-ellipsis"> Tutorial </span> </div> </div> <label class="md-header-nav__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query data-md-state=active> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <button type=reset class="md-search__icon md-icon" aria-label=Clear data-md-component=search-reset tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header-nav__source> <a href=https://github.com/hudikm/TrafficCounterDemo.git title="Go to repository" class=md-source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg> </div> <div class=md-source__repository> TrafficCounterDemo </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=. class="md-tabs__link md-tabs__link--active"> Tutorial </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=https://hudikm.github.io/TrafficCounterDemo/ title="ViewModel: A Simple Example" class="md-nav__button md-logo" aria-label="ViewModel: A Simple Example"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 89 89"><path d="M3.136 17.387v42.932l42.932 21.467L3.136 17.387z"/><path fill-opacity=.5 d="M21.91 8l42.933 64.398-18.775 9.388L3.136 17.387 21.91 8z"/><path d="M67.535 17.387L40.273 35.543l21.878 32.818 5.384 2.691V17.387z"/><path fill-opacity=.25 d="M67.535 17.387v53.666l18.774-9.388V8l-18.774 9.387z"/></svg> </a> ViewModel: A Simple Example </label> <div class=md-nav__source> <a href=https://github.com/hudikm/TrafficCounterDemo.git title="Go to repository" class=md-source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg> </div> <div class=md-source__repository> TrafficCounterDemo </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Tutorial <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"/></svg> </span> </label> <a href=. title=Tutorial class="md-nav__link md-nav__link--active"> Tutorial </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Table of contents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#viewmodel-overview class=md-nav__link> ViewModel Overview </a> </li> <li class=md-nav__item> <a href=#project-structure class=md-nav__link> Project structure </a> </li> <li class=md-nav__item> <a href=#10-basic-functionality class=md-nav__link> 1.0 Basic functionality </a> </li> <li class=md-nav__item> <a href=#viewmodel-overview_1 class=md-nav__link> ViewModel overview </a> <nav class=md-nav aria-label="ViewModel overview"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#11-create-a-viewmodel-class class=md-nav__link> 1.1 Create a ViewModel class </a> </li> <li class=md-nav__item> <a href=#12-add-lifecycle-extensions-to-the-project class=md-nav__link> 1.2 Add lifecycle-extensions to the project </a> </li> <li class=md-nav__item> <a href=#13-associate-the-ui-controller-and-viewmodel class=md-nav__link> 1.3 Associate the UI Controller and ViewModel </a> </li> <li class=md-nav__item> <a href=#14-use-the-viewmodel-in-your-ui-controller class=md-nav__link> 1.4 Use the ViewModel in your UI Controller </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#livedata-overview class=md-nav__link> LiveData overview </a> <nav class=md-nav aria-label="LiveData overview"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#20-create-livedata-objects-in-viewmodel-class class=md-nav__link> 2.0 Create LiveData objects in ViewModel class </a> </li> <li class=md-nav__item> <a href=#21-observe-livedata-objects class=md-nav__link> 2.1 Observe LiveData objects </a> </li> <li class=md-nav__item> <a href=#22-update-livedata-objects class=md-nav__link> 2.2 Update LiveData objects </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </span> Table of contents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#viewmodel-overview class=md-nav__link> ViewModel Overview </a> </li> <li class=md-nav__item> <a href=#project-structure class=md-nav__link> Project structure </a> </li> <li class=md-nav__item> <a href=#10-basic-functionality class=md-nav__link> 1.0 Basic functionality </a> </li> <li class=md-nav__item> <a href=#viewmodel-overview_1 class=md-nav__link> ViewModel overview </a> <nav class=md-nav aria-label="ViewModel overview"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#11-create-a-viewmodel-class class=md-nav__link> 1.1 Create a ViewModel class </a> </li> <li class=md-nav__item> <a href=#12-add-lifecycle-extensions-to-the-project class=md-nav__link> 1.2 Add lifecycle-extensions to the project </a> </li> <li class=md-nav__item> <a href=#13-associate-the-ui-controller-and-viewmodel class=md-nav__link> 1.3 Associate the UI Controller and ViewModel </a> </li> <li class=md-nav__item> <a href=#14-use-the-viewmodel-in-your-ui-controller class=md-nav__link> 1.4 Use the ViewModel in your UI Controller </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#livedata-overview class=md-nav__link> LiveData overview </a> <nav class=md-nav aria-label="LiveData overview"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#20-create-livedata-objects-in-viewmodel-class class=md-nav__link> 2.0 Create LiveData objects in ViewModel class </a> </li> <li class=md-nav__item> <a href=#21-observe-livedata-objects class=md-nav__link> 2.1 Observe LiveData objects </a> </li> <li class=md-nav__item> <a href=#22-update-livedata-objects class=md-nav__link> 2.2 Update LiveData objects </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <h1 id=viewmodel-a-simple-example>ViewModel: A Simple Example<a class=headerlink href=#viewmodel-a-simple-example title="Permanent link">&para;</a></h1> <div class="admonition tip"> <p class=admonition-title><strong>This simple step-by-step tutorial is an example of use of the <a href=https://github.com/hudikm/PatchCreator>tutorial maker tools</a>.</strong></p> </div> <!--tgen file='/home/martin/AndroidStudioProjects/TrafficCounterDemo/out.patch' lang=java tabs t_new="New" t_old="Old" --> <!--___________tgen step=all template='gen_tags_separate_header'  --> <h4 id=viewmodel-overview>ViewModel Overview<a class=headerlink href=#viewmodel-overview title="Permanent link">&para;</a></h4> <p>The <a href=https://developer.android.com/reference/androidx/lifecycle/ViewModel><code>ViewModel</code></a> class is designed to store and manage UI-related data in a lifecycle conscious way. The <a href=https://developer.android.com/reference/androidx/lifecycle/ViewModel><code>ViewModel</code></a> class allows data to survive configuration changes such as screen rotations.</p> <!--tgen step=1.0 template='files_list' noupdate  --> <h4 id=project-structure>Project structure <a href=https://github.com/hudikm/TrafficCounterDemo/commit/5f21036ddb9817a180274c3dea381ffee7ab20ed/ ><img alt=ðŸ”— class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a><a class=headerlink href=#project-structure title="Permanent link">&para;</a></h4> <div class=highlight><pre><span></span><code> .
 â””â”€ app
    â”œâ”€ src
    â”‚  â””â”€ main
    â”‚     â””â”€ java
    â”‚        â””â”€ sk
    â”‚           â””â”€ uniza
    â”‚              â””â”€ trafficcounterdemo
    â”‚                 â””â”€ MainActivity.java
    â””â”€ build.gradle
</code></pre></div> <!--end--> <!--tgen step=1.0 template='mkdocs_header_only'  --> <p><br></p> <h4 id=10-basic-functionality>1.0 Basic functionality <a href=https://github.com/hudikm/TrafficCounterDemo/commit/afaa7056d0c65ceda8092be575807b9205becdbe/ ><img alt=ðŸ”— class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a><a class=headerlink href=#10-basic-functionality title="Permanent link">&para;</a></h4> <!--end--> <p>Start of this project on <a href=https://github.com/hudikm/TrafficCounterDemo/tree/gh-pages>github</a>.</p> <p>Traffic-Counter is a very simple app with buttons that modify counts of cars going in lane 1 or lane 2. The finished app has a bug; After the phone rotation, your traffic counts will inexplicably disappear. This behaviour occur because of the phenomenon called <a href=https://developer.android.com/guide/topics/manifest/activity-element.html#config>"configuration changes"</a>. When you rotate your phone Android OS need to redraw application screen and this is done by simply restarting the whole application. As you can see in code in step 1.0: after restarting the application all variables will be set back to zero.</p> <p><img alt src=images/rotation_viewmodel.gif#center></p> <!--tgen step=1.0 template='mkdocs_body_only'  --> <blockquote> <p><strong><a href=https://github.com/hudikm/TrafficCounterDemo/blob/afaa7056d0c65ceda8092be575807b9205becdbe/app/src/main/java/sk/uniza/trafficcounterdemo/MainActivity.java>ðŸ–¹</a> app/src/main/java/sk/uniza/trafficcounterdemo/MainActivity.java</strong></p> </blockquote> <div class=tabbed-set data-tabs=1:2> <input name=__tabbed_1 type=radio id=__tabbed_1_1 checked=checked><label for=__tabbed_1_1>New</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>android.view.View</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>android.view.Menu</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>android.view.MenuItem</span><span class=p>;</span>
<span class=hll><span class=kn>import</span> <span class=nn>android.widget.TextView</span><span class=p>;</span>
</span>
<span class=kd>public</span> <span class=kd>class</span> <span class=nc>MainActivity</span> <span class=kd>extends</span> <span class=n>AppCompatActivity</span> <span class=p>{</span>

<span class=hll>    <span class=c1>// No. of cars going in up lane</span>
</span><span class=hll>    <span class=kd>private</span> <span class=n>Integer</span> <span class=n>carUp</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span><span class=hll>
</span><span class=hll>    <span class=c1>// No. of vans going in up lane</span>
</span><span class=hll>    <span class=kd>private</span> <span class=n>Integer</span> <span class=n>vanUp</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span><span class=hll>
</span><span class=hll>    <span class=c1>// No. of trucks going in up lane</span>
</span><span class=hll>    <span class=kd>private</span> <span class=n>Integer</span> <span class=n>truckUp</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span><span class=hll>
</span><span class=hll>    <span class=c1>// No. of cars going in down lane</span>
</span><span class=hll>    <span class=kd>private</span> <span class=n>Integer</span> <span class=n>carDown</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span><span class=hll>
</span><span class=hll>    <span class=c1>// No. of vans going in down lane</span>
</span><span class=hll>    <span class=kd>private</span> <span class=n>Integer</span> <span class=n>vanDown</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span><span class=hll>
</span><span class=hll>    <span class=c1>// No. of trucks going in down lane</span>
</span><span class=hll>    <span class=kd>private</span> <span class=n>Integer</span> <span class=n>truckDown</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span><span class=hll>
</span><span class=hll>    <span class=kd>private</span> <span class=n>TextView</span> <span class=n>laneUpCat1</span><span class=p>;</span>
</span><span class=hll>    <span class=kd>private</span> <span class=n>TextView</span> <span class=n>laneUpCat2</span><span class=p>;</span>
</span><span class=hll>    <span class=kd>private</span> <span class=n>TextView</span> <span class=n>laneUpCat3</span><span class=p>;</span>
</span><span class=hll>    <span class=kd>private</span> <span class=n>TextView</span> <span class=n>laneDownCat1</span><span class=p>;</span>
</span><span class=hll>    <span class=kd>private</span> <span class=n>TextView</span> <span class=n>laneDownCat2</span><span class=p>;</span>
</span><span class=hll>    <span class=kd>private</span> <span class=n>TextView</span> <span class=n>laneDownCat3</span><span class=p>;</span>
</span><span class=hll>
</span>    <span class=nd>@Override</span>
    <span class=kd>protected</span> <span class=kt>void</span> <span class=nf>onCreate</span><span class=p>(</span><span class=n>Bundle</span> <span class=n>savedInstanceState</span><span class=p>)</span> <span class=p>{</span>
        <span class=kd>super</span><span class=p>.</span><span class=na>onCreate</span><span class=p>(</span><span class=n>savedInstanceState</span><span class=p>);</span>
        <span class=n>setContentView</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>layout</span><span class=p>.</span><span class=na>activity_main</span><span class=p>);</span>
<span class=hll>        <span class=n>laneUpCat1</span> <span class=o>=</span> <span class=n>findViewById</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>laneUpCat1</span><span class=p>);</span>
</span><span class=hll>        <span class=n>laneUpCat2</span> <span class=o>=</span> <span class=n>findViewById</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>laneUpCat2</span><span class=p>);</span>
</span><span class=hll>        <span class=n>laneUpCat3</span> <span class=o>=</span> <span class=n>findViewById</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>laneUpCat3</span><span class=p>);</span>
</span><span class=hll>
</span><span class=hll>        <span class=n>laneDownCat1</span> <span class=o>=</span> <span class=n>findViewById</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>laneDownCat1</span><span class=p>);</span>
</span><span class=hll>        <span class=n>laneDownCat2</span> <span class=o>=</span> <span class=n>findViewById</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>laneDownCat2</span><span class=p>);</span>
</span><span class=hll>        <span class=n>laneDownCat3</span> <span class=o>=</span> <span class=n>findViewById</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>laneDownCat3</span><span class=p>);</span>
</span>    <span class=p>}</span>


<span class=hll>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>onBtnClick</span><span class=p>(</span><span class=n>View</span> <span class=n>btn</span><span class=p>)</span> <span class=p>{</span>
</span><span class=hll>
</span><span class=hll>        <span class=k>switch</span> <span class=p>(</span><span class=n>btn</span><span class=p>.</span><span class=na>getId</span><span class=p>())</span> <span class=p>{</span>
</span><span class=hll>            <span class=k>case</span> <span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>carDownBtn</span><span class=p>:</span>
</span><span class=hll>                <span class=n>carDown</span><span class=o>++</span><span class=p>;</span>
</span><span class=hll>                <span class=k>break</span><span class=p>;</span>
</span><span class=hll>            <span class=k>case</span> <span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>vanDownBtn</span><span class=p>:</span>
</span><span class=hll>                <span class=n>vanDown</span><span class=o>++</span><span class=p>;</span>
</span><span class=hll>                <span class=k>break</span><span class=p>;</span>
</span><span class=hll>            <span class=k>case</span> <span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>truckDownBtn</span><span class=p>:</span>
</span><span class=hll>                <span class=n>truckDown</span><span class=o>++</span><span class=p>;</span>
</span><span class=hll>                <span class=k>break</span><span class=p>;</span>
</span><span class=hll>            <span class=k>case</span> <span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>carUpBtn</span><span class=p>:</span>
</span><span class=hll>                <span class=n>carUp</span><span class=o>++</span><span class=p>;</span>
</span><span class=hll>                <span class=k>break</span><span class=p>;</span>
</span><span class=hll>            <span class=k>case</span> <span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>vanUpBtn</span><span class=p>:</span>
</span><span class=hll>                <span class=n>vanUp</span><span class=o>++</span><span class=p>;</span>
</span><span class=hll>                <span class=k>break</span><span class=p>;</span>
</span><span class=hll>            <span class=k>case</span> <span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>truckUpBtn</span><span class=p>:</span>
</span><span class=hll>                <span class=n>truckUp</span><span class=o>++</span><span class=p>;</span>
</span><span class=hll>                <span class=k>break</span><span class=p>;</span>
</span><span class=hll>        <span class=p>}</span>
</span><span class=hll>        <span class=n>updateUi</span><span class=p>();</span>
</span><span class=hll>    <span class=p>}</span>
</span><span class=hll>
</span><span class=hll>    <span class=kd>private</span> <span class=kt>void</span> <span class=nf>updateUi</span><span class=p>()</span> <span class=p>{</span>
</span><span class=hll>        <span class=n>laneDownCat1</span><span class=p>.</span><span class=na>setText</span><span class=p>(</span><span class=n>carDown</span><span class=p>.</span><span class=na>toString</span><span class=p>());</span>
</span><span class=hll>        <span class=n>laneDownCat2</span><span class=p>.</span><span class=na>setText</span><span class=p>(</span><span class=n>vanDown</span><span class=p>.</span><span class=na>toString</span><span class=p>());</span>
</span><span class=hll>        <span class=n>laneDownCat3</span><span class=p>.</span><span class=na>setText</span><span class=p>(</span><span class=n>truckDown</span><span class=p>.</span><span class=na>toString</span><span class=p>());</span>
</span><span class=hll>
</span><span class=hll>        <span class=n>laneUpCat1</span><span class=p>.</span><span class=na>setText</span><span class=p>(</span><span class=n>carUp</span><span class=p>.</span><span class=na>toString</span><span class=p>());</span>
</span><span class=hll>        <span class=n>laneUpCat2</span><span class=p>.</span><span class=na>setText</span><span class=p>(</span><span class=n>vanUp</span><span class=p>.</span><span class=na>toString</span><span class=p>());</span>
</span><span class=hll>        <span class=n>laneUpCat3</span><span class=p>.</span><span class=na>setText</span><span class=p>(</span><span class=n>truckUp</span><span class=p>.</span><span class=na>toString</span><span class=p>());</span>
</span><span class=hll>    <span class=p>}</span>
</span><span class=hll>
</span><span class=p>}</span>
</code></pre></div></div> <input name=__tabbed_1 type=radio id=__tabbed_1_2><label for=__tabbed_1_2>Old</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>android.view.View</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>android.view.Menu</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>android.view.MenuItem</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>MainActivity</span> <span class=kd>extends</span> <span class=n>AppCompatActivity</span> <span class=p>{</span>

    <span class=nd>@Override</span>
    <span class=kd>protected</span> <span class=kt>void</span> <span class=nf>onCreate</span><span class=p>(</span><span class=n>Bundle</span> <span class=n>savedInstanceState</span><span class=p>)</span> <span class=p>{</span>
        <span class=kd>super</span><span class=p>.</span><span class=na>onCreate</span><span class=p>(</span><span class=n>savedInstanceState</span><span class=p>);</span>
        <span class=n>setContentView</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>layout</span><span class=p>.</span><span class=na>activity_main</span><span class=p>);</span>
    <span class=p>}</span>


<span class=p>}</span>
</code></pre></div></div> </div> <!--end--> <p><br></p> <h3 id=viewmodel-overview_1>ViewModel overview<a class=headerlink href=#viewmodel-overview_1 title="Permanent link">&para;</a></h3> <p><strong>Dealing with the problem of restarting the application</strong></p> <p>To understand the problem, you need to <a href=https://developer.android.com/guide/components/activities/activity-lifecycle>understand the activity lifecycle</a>. Activity might cycle through different states many times not only due to the configuration changes.</p> <p><img alt src=images/life_cycle.png#center></p> <p>There are more options how to avoid data lost due to screen rotation:</p> <ul> <li>turn off the screen rotation (<strong>not recommended</strong>)</li> <li>save and retrieve data to/from bundle object in methods: <code>onSaveInstanceState</code>,<code>onRestoreInstanceState</code></li> <li>use fragment with <a href=https://developer.android.com/reference/android/app/Fragment#setRetainInstance(boolean)><code>setRetainInstance(true)</code></a>(<strong>deprecated</strong>) </li> <li>use ViewModels (<strong>recommended</strong>)</li> </ul> <!--tgen step=1.1 template='mkdocs_header_only'  --> <p><br></p> <h4 id=11-create-a-viewmodel-class>1.1 Create a ViewModel class <a href=https://github.com/hudikm/TrafficCounterDemo/commit/292eb1719d3d34aac984285fd468b6b41701abe6/ ><img alt=ðŸ”— class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a><a class=headerlink href=#11-create-a-viewmodel-class title="Permanent link">&para;</a></h4> <!--end--> <p>To store the data outside of the activity where they are not affected by an activity lifecycle we can use <code>ViewModel</code> class.</p> <p>In the diagram below, you can see the lifecycle of an Activity which undergoes a restart due to the rotation of a screen and then it is finally finished. The lifetime of the ViewModel is shown next to the associated Activity lifecycle. Note that ViewModels can be easily used with both Fragments and Activities.</p> <p><img alt src=images/viewmodel.png#center></p> <p>The ViewModel exists from when you first request an instance of class ViewModel (usually in the <code>onCreate</code> the Activity) until the associated Activity is finished and destroyed. <code>onCreate</code> may be called several times during the life of an Activity, such as when the app is rotated, but the ViewModel is not affected.</p> <p>Continue with below steps to finished the application.</p> <!--tgen step=1.1 template='files_list' noupdate --> <p><strong>Create new class TrafficCounterViewModel.java <a href=https://github.com/hudikm/TrafficCounterDemo/commit/d98d7c1637478d61e5abdef52bda20db7c3f74f6/ ><img alt=ðŸ”— class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a></strong></p> <div class=highlight><pre><span></span><code> .
 â””â”€ app
    â”œâ”€ src
    â”‚  â””â”€ main
    â”‚     â””â”€ java
    â”‚        â””â”€ sk
    â”‚           â””â”€ uniza
    â”‚              â””â”€ trafficcounterdemo
    â”‚                 â”œâ”€ MainActivity.java
    â”‚                 â””â”€ TrafficCounterViewModel.java   # create new file
    â””â”€ build.gradle
</code></pre></div> <!--end--> <!--tgen step=1.1 template='mkdocs_body_only'  --> <blockquote> <p><strong><a href=https://github.com/hudikm/TrafficCounterDemo/blob/292eb1719d3d34aac984285fd468b6b41701abe6/app/src/main/java/sk/uniza/trafficcounterdemo/MainActivity.java>ðŸ–¹</a> app/src/main/java/sk/uniza/trafficcounterdemo/MainActivity.java</strong></p> </blockquote> <div class=tabbed-set data-tabs=2:2> <input name=__tabbed_2 type=radio id=__tabbed_2_1 checked=checked><label for=__tabbed_2_1>New</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kd>public</span> <span class=kd>class</span> <span class=nc>MainActivity</span> <span class=kd>extends</span> <span class=n>AppCompatActivity</span> <span class=p>{</span>

    <span class=kd>private</span> <span class=n>TextView</span> <span class=n>laneUpCat1</span><span class=p>;</span>
    <span class=kd>private</span> <span class=n>TextView</span> <span class=n>laneUpCat2</span><span class=p>;</span>
    <span class=kd>private</span> <span class=n>TextView</span> <span class=n>laneUpCat3</span><span class=p>;</span>
</code></pre></div></div> <input name=__tabbed_2 type=radio id=__tabbed_2_2><label for=__tabbed_2_2>Old</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kd>public</span> <span class=kd>class</span> <span class=nc>MainActivity</span> <span class=kd>extends</span> <span class=n>AppCompatActivity</span> <span class=p>{</span>

<span class=hll>    <span class=c1>// No. of cars going in up lane</span>
</span><span class=hll>    <span class=kd>private</span> <span class=n>Integer</span> <span class=n>carUp</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span><span class=hll>
</span><span class=hll>    <span class=c1>// No. of vans going in up lane</span>
</span><span class=hll>    <span class=kd>private</span> <span class=n>Integer</span> <span class=n>vanUp</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span><span class=hll>
</span><span class=hll>    <span class=c1>// No. of trucks going in up lane</span>
</span><span class=hll>    <span class=kd>private</span> <span class=n>Integer</span> <span class=n>truckUp</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span><span class=hll>
</span><span class=hll>    <span class=c1>// No. of cars going in down lane</span>
</span><span class=hll>    <span class=kd>private</span> <span class=n>Integer</span> <span class=n>carDown</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span><span class=hll>
</span><span class=hll>    <span class=c1>// No. of vans going in down lane</span>
</span><span class=hll>    <span class=kd>private</span> <span class=n>Integer</span> <span class=n>vanDown</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span><span class=hll>
</span><span class=hll>    <span class=c1>// No. of trucks going in down lane</span>
</span><span class=hll>    <span class=kd>private</span> <span class=n>Integer</span> <span class=n>truckDown</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span><span class=hll>
</span>    <span class=kd>private</span> <span class=n>TextView</span> <span class=n>laneUpCat1</span><span class=p>;</span>
    <span class=kd>private</span> <span class=n>TextView</span> <span class=n>laneUpCat2</span><span class=p>;</span>
    <span class=kd>private</span> <span class=n>TextView</span> <span class=n>laneUpCat3</span><span class=p>;</span>
</code></pre></div></div> </div> <blockquote> <p><strong><a href=https://github.com/hudikm/TrafficCounterDemo/blob/292eb1719d3d34aac984285fd468b6b41701abe6/app/src/main/java/sk/uniza/trafficcounterdemo/TrafficCounterViewModel.java>ðŸ–¹</a> app/src/main/java/sk/uniza/trafficcounterdemo/TrafficCounterViewModel.java</strong></p> </blockquote> <div class=tabbed-set data-tabs=3:1> <input name=__tabbed_3 type=radio id=__tabbed_3_1 checked=checked><label for=__tabbed_3_1>New</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=hll><span class=kn>package</span> <span class=nn>sk.uniza.trafficcounterdemo</span><span class=p>;</span>
</span><span class=hll>
</span><span class=hll><span class=kn>import</span> <span class=nn>androidx.lifecycle.ViewModel</span><span class=p>;</span>
</span><span class=hll>
</span><span class=hll><span class=kd>public</span> <span class=kd>class</span> <span class=nc>TrafficCounterViewModel</span> <span class=kd>extends</span> <span class=n>ViewModel</span> <span class=p>{</span>
</span><span class=hll>    <span class=c1>// No. of cars going in up lane</span>
</span><span class=hll>    <span class=kd>public</span> <span class=n>Integer</span> <span class=n>carUp</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span><span class=hll>
</span><span class=hll>    <span class=c1>// No. of vans going in up lane</span>
</span><span class=hll>    <span class=kd>public</span> <span class=n>Integer</span> <span class=n>vanUp</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span><span class=hll>
</span><span class=hll>    <span class=c1>// No. of trucks going in up lane</span>
</span><span class=hll>    <span class=kd>public</span> <span class=n>Integer</span> <span class=n>truckUp</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span><span class=hll>
</span><span class=hll>    <span class=c1>// No. of cars going in down lane</span>
</span><span class=hll>    <span class=kd>public</span> <span class=n>Integer</span> <span class=n>carDown</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span><span class=hll>
</span><span class=hll>    <span class=c1>// No. of vans going in down lane</span>
</span><span class=hll>    <span class=kd>public</span> <span class=n>Integer</span> <span class=n>vanDown</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span><span class=hll>
</span><span class=hll>    <span class=c1>// No. of trucks going in down lane</span>
</span><span class=hll>    <span class=kd>public</span> <span class=n>Integer</span> <span class=n>truckDown</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span><span class=hll><span class=p>}</span>
</span></code></pre></div></div> </div> <!--end--> <!--tgen step=1.2 template='mkdocs_header_only'  --> <p><br></p> <h4 id=12-add-lifecycle-extensions-to-the-project>1.2 Add lifecycle-extensions to the project <a href=https://github.com/hudikm/TrafficCounterDemo/commit/24a1de18d28242f0e0e6a1c69d47661ca0f234ae/ ><img alt=ðŸ”— class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a><a class=headerlink href=#12-add-lifecycle-extensions-to-the-project title="Permanent link">&para;</a></h4> <!--end--> <!--tgen step=1.2 template='mkdocs_body_only'  --> <blockquote> <p><strong><a href=https://github.com/hudikm/TrafficCounterDemo/blob/24a1de18d28242f0e0e6a1c69d47661ca0f234ae/app/build.gradle>ðŸ–¹</a> app/build.gradle</strong></p> <p>dependencies {</p> </blockquote> <div class=tabbed-set data-tabs=4:2> <input name=__tabbed_4 type=radio id=__tabbed_4_1 checked=checked><label for=__tabbed_4_1>New</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=n>testImplementation</span> <span class=err>&#39;</span><span class=n>junit</span><span class=p>:</span><span class=n>junit</span><span class=p>:</span><span class=mf>4.12</span><span class=err>&#39;</span>
    <span class=n>androidTestImplementation</span> <span class=err>&#39;</span><span class=n>androidx</span><span class=p>.</span><span class=na>test</span><span class=p>.</span><span class=na>ext</span><span class=p>:</span><span class=n>junit</span><span class=p>:</span><span class=mf>1.1.1</span><span class=err>&#39;</span>
    <span class=n>androidTestImplementation</span> <span class=err>&#39;</span><span class=n>androidx</span><span class=p>.</span><span class=na>test</span><span class=p>.</span><span class=na>espresso</span><span class=p>:</span><span class=n>espresso</span><span class=o>-</span><span class=n>core</span><span class=p>:</span><span class=mf>3.2.0</span><span class=err>&#39;</span>
<span class=hll>    <span class=n>implementation</span> <span class=err>&#39;</span><span class=n>androidx</span><span class=p>.</span><span class=na>lifecycle</span><span class=p>:</span><span class=n>lifecycle</span><span class=o>-</span><span class=n>extensions</span><span class=p>:</span><span class=mf>2.2.0</span><span class=err>&#39;</span>
</span><span class=p>}</span>
</code></pre></div></div> <input name=__tabbed_4 type=radio id=__tabbed_4_2><label for=__tabbed_4_2>Old</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=n>testImplementation</span> <span class=err>&#39;</span><span class=n>junit</span><span class=p>:</span><span class=n>junit</span><span class=p>:</span><span class=mf>4.12</span><span class=err>&#39;</span>
    <span class=n>androidTestImplementation</span> <span class=err>&#39;</span><span class=n>androidx</span><span class=p>.</span><span class=na>test</span><span class=p>.</span><span class=na>ext</span><span class=p>:</span><span class=n>junit</span><span class=p>:</span><span class=mf>1.1.1</span><span class=err>&#39;</span>
    <span class=n>androidTestImplementation</span> <span class=err>&#39;</span><span class=n>androidx</span><span class=p>.</span><span class=na>test</span><span class=p>.</span><span class=na>espresso</span><span class=p>:</span><span class=n>espresso</span><span class=o>-</span><span class=n>core</span><span class=p>:</span><span class=mf>3.2.0</span><span class=err>&#39;</span>
<span class=p>}</span>
</code></pre></div></div> </div> <!--end--> <!--tgen step=1.3 template='mkdocs_header_only'  --> <p><br></p> <h4 id=13-associate-the-ui-controller-and-viewmodel>1.3 Associate the UI Controller and ViewModel <a href=https://github.com/hudikm/TrafficCounterDemo/commit/7cad36cd8aa245295c4c64ac03a3243c85128fd0/ ><img alt=ðŸ”— class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a><a class=headerlink href=#13-associate-the-ui-controller-and-viewmodel title="Permanent link">&para;</a></h4> <!--end--> <!--tgen step=1.3 template='mkdocs_body_only'  --> <blockquote> <p><strong><a href=https://github.com/hudikm/TrafficCounterDemo/blob/7cad36cd8aa245295c4c64ac03a3243c85128fd0/app/src/main/java/sk/uniza/trafficcounterdemo/MainActivity.java>ðŸ–¹</a> app/src/main/java/sk/uniza/trafficcounterdemo/MainActivity.java</strong></p> </blockquote> <div class=tabbed-set data-tabs=5:4> <input name=__tabbed_5 type=radio id=__tabbed_5_1 checked=checked><label for=__tabbed_5_1>New</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>androidx.appcompat.app.AppCompatActivity</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>androidx.appcompat.widget.Toolbar</span><span class=p>;</span>
<span class=hll><span class=kn>import</span> <span class=nn>androidx.lifecycle.ViewModelProvider</span><span class=p>;</span>
</span><span class=hll><span class=kn>import</span> <span class=nn>androidx.lifecycle.ViewModelProviders</span><span class=p>;</span>
</span>
<span class=kn>import</span> <span class=nn>android.view.View</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>android.view.Menu</span><span class=p>;</span>
</code></pre></div></div> <input name=__tabbed_5 type=radio id=__tabbed_5_2><label for=__tabbed_5_2>Old</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>androidx.appcompat.app.AppCompatActivity</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>androidx.appcompat.widget.Toolbar</span><span class=p>;</span>

<span class=kn>import</span> <span class=nn>android.view.View</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>android.view.Menu</span><span class=p>;</span>
</code></pre></div></div> <input name=__tabbed_5 type=radio id=__tabbed_5_3><label for=__tabbed_5_3>New</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=kd>private</span> <span class=n>TextView</span> <span class=n>laneDownCat1</span><span class=p>;</span>
    <span class=kd>private</span> <span class=n>TextView</span> <span class=n>laneDownCat2</span><span class=p>;</span>
    <span class=kd>private</span> <span class=n>TextView</span> <span class=n>laneDownCat3</span><span class=p>;</span>
<span class=hll>    <span class=kd>private</span> <span class=n>TrafficCounterViewModel</span> <span class=n>trafficCounterViewModel</span><span class=p>;</span>
</span>
    <span class=nd>@Override</span>
    <span class=kd>protected</span> <span class=kt>void</span> <span class=nf>onCreate</span><span class=p>(</span><span class=n>Bundle</span> <span class=n>savedInstanceState</span><span class=p>)</span> <span class=p>{</span>
</code></pre></div></div> <input name=__tabbed_5 type=radio id=__tabbed_5_4><label for=__tabbed_5_4>Old</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=kd>private</span> <span class=n>TextView</span> <span class=n>laneDownCat1</span><span class=p>;</span>
    <span class=kd>private</span> <span class=n>TextView</span> <span class=n>laneDownCat2</span><span class=p>;</span>
    <span class=kd>private</span> <span class=n>TextView</span> <span class=n>laneDownCat3</span><span class=p>;</span>

    <span class=nd>@Override</span>
    <span class=kd>protected</span> <span class=kt>void</span> <span class=nf>onCreate</span><span class=p>(</span><span class=n>Bundle</span> <span class=n>savedInstanceState</span><span class=p>)</span> <span class=p>{</span>
</code></pre></div></div> </div> <blockquote> <p>protected void onCreate(Bundle savedInstanceState) {</p> </blockquote> <div class=tabbed-set data-tabs=6:2> <input name=__tabbed_6 type=radio id=__tabbed_6_1 checked=checked><label for=__tabbed_6_1>New</label><div class=tabbed-content><div class=highlight><pre><span></span><code>        <span class=n>laneDownCat1</span> <span class=o>=</span> <span class=n>findViewById</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>laneDownCat1</span><span class=p>);</span>
        <span class=n>laneDownCat2</span> <span class=o>=</span> <span class=n>findViewById</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>laneDownCat2</span><span class=p>);</span>
        <span class=n>laneDownCat3</span> <span class=o>=</span> <span class=n>findViewById</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>laneDownCat3</span><span class=p>);</span>
<span class=hll>        <span class=n>trafficCounterViewModel</span> <span class=o>=</span>
</span><span class=hll>                <span class=k>new</span> <span class=n>ViewModelProvider</span><span class=p>(</span><span class=k>this</span><span class=p>)</span>
</span><span class=hll>                <span class=p>.</span><span class=na>get</span><span class=p>(</span><span class=n>TrafficCounterViewModel</span><span class=p>.</span><span class=na>class</span><span class=p>);</span>
</span><span class=hll>
</span><span class=hll>        <span class=n>updateUi</span><span class=p>();</span>
</span>    <span class=p>}</span>
</code></pre></div></div> <input name=__tabbed_6 type=radio id=__tabbed_6_2><label for=__tabbed_6_2>Old</label><div class=tabbed-content><div class=highlight><pre><span></span><code>        <span class=n>laneDownCat1</span> <span class=o>=</span> <span class=n>findViewById</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>laneDownCat1</span><span class=p>);</span>
        <span class=n>laneDownCat2</span> <span class=o>=</span> <span class=n>findViewById</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>laneDownCat2</span><span class=p>);</span>
        <span class=n>laneDownCat3</span> <span class=o>=</span> <span class=n>findViewById</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>laneDownCat3</span><span class=p>);</span>
    <span class=p>}</span>
</code></pre></div></div> </div> <!--end--> <!--tgen step=1.4 template='mkdocs_header_only'  --> <p><br></p> <h4 id=14-use-the-viewmodel-in-your-ui-controller>1.4 Use the ViewModel in your UI Controller <a href=https://github.com/hudikm/TrafficCounterDemo/commit/997dcbf7bd556fbdd8580909f4a6892adb79babe/ ><img alt=ðŸ”— class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a><a class=headerlink href=#14-use-the-viewmodel-in-your-ui-controller title="Permanent link">&para;</a></h4> <!--end--> <!--tgen step=1.4 template='mkdocs_body_only'  --> <blockquote> <p><strong><a href=https://github.com/hudikm/TrafficCounterDemo/blob/997dcbf7bd556fbdd8580909f4a6892adb79babe/app/src/main/java/sk/uniza/trafficcounterdemo/MainActivity.java>ðŸ–¹</a> app/src/main/java/sk/uniza/trafficcounterdemo/MainActivity.java</strong></p> <p>public void onBtnClick(View btn) {</p> </blockquote> <div class=tabbed-set data-tabs=7:2> <input name=__tabbed_7 type=radio id=__tabbed_7_1 checked=checked><label for=__tabbed_7_1>New</label><div class=tabbed-content><div class=highlight><pre><span></span><code>        <span class=k>switch</span> <span class=p>(</span><span class=n>btn</span><span class=p>.</span><span class=na>getId</span><span class=p>())</span> <span class=p>{</span>
            <span class=k>case</span> <span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>carDownBtn</span><span class=p>:</span>
<span class=hll>                <span class=n>trafficCounterViewModel</span><span class=p>.</span><span class=na>carDown</span><span class=o>++</span><span class=p>;</span>
</span>                <span class=k>break</span><span class=p>;</span>
            <span class=k>case</span> <span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>vanDownBtn</span><span class=p>:</span>
<span class=hll>                <span class=n>trafficCounterViewModel</span><span class=p>.</span><span class=na>vanDown</span><span class=o>++</span><span class=p>;</span>
</span>                <span class=k>break</span><span class=p>;</span>
            <span class=k>case</span> <span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>truckDownBtn</span><span class=p>:</span>
<span class=hll>                <span class=n>trafficCounterViewModel</span><span class=p>.</span><span class=na>truckDown</span><span class=o>++</span><span class=p>;</span>
</span>                <span class=k>break</span><span class=p>;</span>
            <span class=k>case</span> <span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>carUpBtn</span><span class=p>:</span>
<span class=hll>                <span class=n>trafficCounterViewModel</span><span class=p>.</span><span class=na>carUp</span><span class=o>++</span><span class=p>;</span>
</span>                <span class=k>break</span><span class=p>;</span>
            <span class=k>case</span> <span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>vanUpBtn</span><span class=p>:</span>
<span class=hll>                <span class=n>trafficCounterViewModel</span><span class=p>.</span><span class=na>vanUp</span><span class=o>++</span><span class=p>;</span>
</span>                <span class=k>break</span><span class=p>;</span>
            <span class=k>case</span> <span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>truckUpBtn</span><span class=p>:</span>
<span class=hll>                <span class=n>trafficCounterViewModel</span><span class=p>.</span><span class=na>truckUp</span><span class=o>++</span><span class=p>;</span>
</span>                <span class=k>break</span><span class=p>;</span>
        <span class=p>}</span>
        <span class=n>updateUi</span><span class=p>();</span>
    <span class=p>}</span>

    <span class=kd>private</span> <span class=kt>void</span> <span class=nf>updateUi</span><span class=p>()</span> <span class=p>{</span>
<span class=hll>        <span class=n>laneDownCat1</span><span class=p>.</span><span class=na>setText</span><span class=p>(</span><span class=n>trafficCounterViewModel</span><span class=p>.</span><span class=na>carDown</span><span class=p>.</span><span class=na>toString</span><span class=p>());</span>
</span><span class=hll>        <span class=n>laneDownCat2</span><span class=p>.</span><span class=na>setText</span><span class=p>(</span><span class=n>trafficCounterViewModel</span><span class=p>.</span><span class=na>vanDown</span><span class=p>.</span><span class=na>toString</span><span class=p>());</span>
</span><span class=hll>        <span class=n>laneDownCat3</span><span class=p>.</span><span class=na>setText</span><span class=p>(</span><span class=n>trafficCounterViewModel</span><span class=p>.</span><span class=na>truckDown</span><span class=p>.</span><span class=na>toString</span><span class=p>());</span>
</span>
<span class=hll>        <span class=n>laneUpCat1</span><span class=p>.</span><span class=na>setText</span><span class=p>(</span><span class=n>trafficCounterViewModel</span><span class=p>.</span><span class=na>carUp</span><span class=p>.</span><span class=na>toString</span><span class=p>());</span>
</span><span class=hll>        <span class=n>laneUpCat2</span><span class=p>.</span><span class=na>setText</span><span class=p>(</span><span class=n>trafficCounterViewModel</span><span class=p>.</span><span class=na>vanUp</span><span class=p>.</span><span class=na>toString</span><span class=p>());</span>
</span><span class=hll>        <span class=n>laneUpCat3</span><span class=p>.</span><span class=na>setText</span><span class=p>(</span><span class=n>trafficCounterViewModel</span><span class=p>.</span><span class=na>truckUp</span><span class=p>.</span><span class=na>toString</span><span class=p>());</span>
</span>    <span class=p>}</span>

<span class=p>}</span>
</code></pre></div></div> <input name=__tabbed_7 type=radio id=__tabbed_7_2><label for=__tabbed_7_2>Old</label><div class=tabbed-content><div class=highlight><pre><span></span><code>        <span class=k>switch</span> <span class=p>(</span><span class=n>btn</span><span class=p>.</span><span class=na>getId</span><span class=p>())</span> <span class=p>{</span>
            <span class=k>case</span> <span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>carDownBtn</span><span class=p>:</span>
<span class=hll>                <span class=n>carDown</span><span class=o>++</span><span class=p>;</span>
</span>                <span class=k>break</span><span class=p>;</span>
            <span class=k>case</span> <span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>vanDownBtn</span><span class=p>:</span>
<span class=hll>                <span class=n>vanDown</span><span class=o>++</span><span class=p>;</span>
</span>                <span class=k>break</span><span class=p>;</span>
            <span class=k>case</span> <span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>truckDownBtn</span><span class=p>:</span>
<span class=hll>                <span class=n>truckDown</span><span class=o>++</span><span class=p>;</span>
</span>                <span class=k>break</span><span class=p>;</span>
            <span class=k>case</span> <span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>carUpBtn</span><span class=p>:</span>
<span class=hll>                <span class=n>carUp</span><span class=o>++</span><span class=p>;</span>
</span>                <span class=k>break</span><span class=p>;</span>
            <span class=k>case</span> <span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>vanUpBtn</span><span class=p>:</span>
<span class=hll>                <span class=n>vanUp</span><span class=o>++</span><span class=p>;</span>
</span>                <span class=k>break</span><span class=p>;</span>
            <span class=k>case</span> <span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>truckUpBtn</span><span class=p>:</span>
<span class=hll>                <span class=n>truckUp</span><span class=o>++</span><span class=p>;</span>
</span>                <span class=k>break</span><span class=p>;</span>
        <span class=p>}</span>
        <span class=n>updateUi</span><span class=p>();</span>
    <span class=p>}</span>

    <span class=kd>private</span> <span class=kt>void</span> <span class=nf>updateUi</span><span class=p>()</span> <span class=p>{</span>
<span class=hll>        <span class=n>laneDownCat1</span><span class=p>.</span><span class=na>setText</span><span class=p>(</span><span class=n>carDown</span><span class=p>.</span><span class=na>toString</span><span class=p>());</span>
</span><span class=hll>        <span class=n>laneDownCat2</span><span class=p>.</span><span class=na>setText</span><span class=p>(</span><span class=n>vanDown</span><span class=p>.</span><span class=na>toString</span><span class=p>());</span>
</span><span class=hll>        <span class=n>laneDownCat3</span><span class=p>.</span><span class=na>setText</span><span class=p>(</span><span class=n>truckDown</span><span class=p>.</span><span class=na>toString</span><span class=p>());</span>
</span>
<span class=hll>        <span class=n>laneUpCat1</span><span class=p>.</span><span class=na>setText</span><span class=p>(</span><span class=n>carUp</span><span class=p>.</span><span class=na>toString</span><span class=p>());</span>
</span><span class=hll>        <span class=n>laneUpCat2</span><span class=p>.</span><span class=na>setText</span><span class=p>(</span><span class=n>vanUp</span><span class=p>.</span><span class=na>toString</span><span class=p>());</span>
</span><span class=hll>        <span class=n>laneUpCat3</span><span class=p>.</span><span class=na>setText</span><span class=p>(</span><span class=n>truckUp</span><span class=p>.</span><span class=na>toString</span><span class=p>());</span>
</span>    <span class=p>}</span>

<span class=p>}</span>
</code></pre></div></div> </div> <!--end--> <p><br></p> <div class="admonition info"> <p class=admonition-title>At this point you can try to <em>run</em> the application and see how it works</p> </div> <p><br></p> <h3 id=livedata-overview>LiveData overview<a class=headerlink href=#livedata-overview title="Permanent link">&para;</a></h3> <p><a href=https://developer.android.com/topic/libraries/architecture/livedata><code>LiveData</code></a> is an observable data holder class. Unlike a regular observable, LiveData is lifecycle-aware, meaning it respects the lifecycle of other app components, such as activities, fragments, or services. This awareness ensures LiveData only updates app component observers that are in an active lifecycle state.</p> <p><strong>Work with LiveData objects</strong></p> <p>Follow these steps to work with <a href=https://developer.android.com/reference/androidx/lifecycle/LiveData><code>LiveData</code></a> objects:</p> <ol> <li>Create an instance of <code>LiveData</code> to hold a certain type of data. This is usually done within your <a href=https://developer.android.com/reference/androidx/lifecycle/ViewModel><code>ViewModel</code></a> class.</li> <li>Create an <a href=https://developer.android.com/reference/androidx/lifecycle/Observer><code>Observer</code></a> object that defines the <a href=https://developer.android.com/reference/androidx/lifecycle/Observer#onChanged(T)><code>onChanged()</code></a> method, which controls what happens when the <code>LiveData</code> object's held data changes. You usually create an <code>Observer</code> object in a UI controller, such as an activity or fragment.</li> <li>Attach the <code>Observer</code> object to the <code>LiveData</code> object using the <a href="https://developer.android.com/reference/androidx/lifecycle/LiveData#observe(android.arch.lifecycle.LifecycleOwner, android.arch.lifecycle.Observer)"><code>observe()</code></a> method. The <code>observe()</code> method takes a <a href=https://developer.android.com/reference/androidx/lifecycle/LifecycleOwner><code>LifecycleOwner</code></a> object. This subscribes the <code>Observer</code> object to the <code>LiveData</code> object so that it is notified of changes. You usually attach the <code>Observer</code> object in a UI controller, such as an activity or fragment.</li> </ol> <p><br></p> <!--tgen step=2.0 template='mkdocs_header_only'  --> <p><br></p> <h4 id=20-create-livedata-objects-in-viewmodel-class>2.0 Create LiveData objects in ViewModel class <a href=https://github.com/hudikm/TrafficCounterDemo/commit/1f5ad8a2cb4932e6d639c546b9fddb6f43b3c047/ ><img alt=ðŸ”— class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a><a class=headerlink href=#20-create-livedata-objects-in-viewmodel-class title="Permanent link">&para;</a></h4> <!--end--> <!--tgen step=2.0 template='mkdocs_body_only'  --> <blockquote> <p><strong><a href=https://github.com/hudikm/TrafficCounterDemo/blob/1f5ad8a2cb4932e6d639c546b9fddb6f43b3c047/app/src/main/java/sk/uniza/trafficcounterdemo/TrafficCounterViewModel.java>ðŸ–¹</a> app/src/main/java/sk/uniza/trafficcounterdemo/TrafficCounterViewModel.java</strong></p> </blockquote> <div class=tabbed-set data-tabs=8:2> <input name=__tabbed_8 type=radio id=__tabbed_8_1 checked=checked><label for=__tabbed_8_1>New</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>package</span> <span class=nn>sk.uniza.trafficcounterdemo</span><span class=p>;</span>

<span class=hll><span class=kn>import</span> <span class=nn>androidx.lifecycle.MutableLiveData</span><span class=p>;</span>
</span><span class=kn>import</span> <span class=nn>androidx.lifecycle.ViewModel</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>TrafficCounterViewModel</span> <span class=kd>extends</span> <span class=n>ViewModel</span> <span class=p>{</span>
    <span class=c1>// No. of cars going in up lane</span>
<span class=hll>    <span class=kd>public</span> <span class=n>MutableLiveData</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>carUp</span> <span class=o>=</span> <span class=k>new</span> <span class=n>MutableLiveData</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span>
    <span class=c1>// No. of vans going in up lane</span>
<span class=hll>    <span class=kd>public</span> <span class=n>MutableLiveData</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>vanUp</span> <span class=o>=</span> <span class=k>new</span> <span class=n>MutableLiveData</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span>
    <span class=c1>// No. of trucks going in up lane</span>
<span class=hll>    <span class=kd>public</span> <span class=n>MutableLiveData</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>truckUp</span> <span class=o>=</span> <span class=k>new</span> <span class=n>MutableLiveData</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span>
    <span class=c1>// No. of cars going in down lane</span>
<span class=hll>    <span class=kd>public</span> <span class=n>MutableLiveData</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>carDown</span> <span class=o>=</span> <span class=k>new</span> <span class=n>MutableLiveData</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span>
    <span class=c1>// No. of vans going in down lane</span>
<span class=hll>    <span class=kd>public</span> <span class=n>MutableLiveData</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>vanDown</span> <span class=o>=</span> <span class=k>new</span> <span class=n>MutableLiveData</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span>
    <span class=c1>// No. of trucks going in down lane</span>
<span class=hll>    <span class=kd>public</span> <span class=n>MutableLiveData</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>truckDown</span> <span class=o>=</span> <span class=k>new</span> <span class=n>MutableLiveData</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span><span class=hll>
</span><span class=p>}</span>
</code></pre></div></div> <input name=__tabbed_8 type=radio id=__tabbed_8_2><label for=__tabbed_8_2>Old</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>package</span> <span class=nn>sk.uniza.trafficcounterdemo</span><span class=p>;</span>

<span class=kn>import</span> <span class=nn>androidx.lifecycle.ViewModel</span><span class=p>;</span>

<span class=kd>public</span> <span class=kd>class</span> <span class=nc>TrafficCounterViewModel</span> <span class=kd>extends</span> <span class=n>ViewModel</span> <span class=p>{</span>
    <span class=c1>// No. of cars going in up lane</span>
<span class=hll>    <span class=kd>public</span> <span class=n>Integer</span> <span class=n>carUp</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span>
    <span class=c1>// No. of vans going in up lane</span>
<span class=hll>    <span class=kd>public</span> <span class=n>Integer</span> <span class=n>vanUp</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span>
    <span class=c1>// No. of trucks going in up lane</span>
<span class=hll>    <span class=kd>public</span> <span class=n>Integer</span> <span class=n>truckUp</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span>
    <span class=c1>// No. of cars going in down lane</span>
<span class=hll>    <span class=kd>public</span> <span class=n>Integer</span> <span class=n>carDown</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span>
    <span class=c1>// No. of vans going in down lane</span>
<span class=hll>    <span class=kd>public</span> <span class=n>Integer</span> <span class=n>vanDown</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span>
    <span class=c1>// No. of trucks going in down lane</span>
<span class=hll>    <span class=kd>public</span> <span class=n>Integer</span> <span class=n>truckDown</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span><span class=p>}</span>
</code></pre></div></div> </div> <!--end--> <!--tgen step=2.1 template='mkdocs_header_only'  --> <p><br></p> <h4 id=21-observe-livedata-objects>2.1 Observe LiveData objects <a href=https://github.com/hudikm/TrafficCounterDemo/commit/e92ab48512a1710ef33ba52ce365cf3519b6fbcd/ ><img alt=ðŸ”— class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a><a class=headerlink href=#21-observe-livedata-objects title="Permanent link">&para;</a></h4> <!--end--> <!--tgen step=2.1 template='mkdocs_body_only'  --> <blockquote> <p><strong><a href=https://github.com/hudikm/TrafficCounterDemo/blob/e92ab48512a1710ef33ba52ce365cf3519b6fbcd/app/src/main/java/sk/uniza/trafficcounterdemo/MainActivity.java>ðŸ–¹</a> app/src/main/java/sk/uniza/trafficcounterdemo/MainActivity.java</strong></p> </blockquote> <div class=tabbed-set data-tabs=9:2> <input name=__tabbed_9 type=radio id=__tabbed_9_1 checked=checked><label for=__tabbed_9_1>New</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>androidx.appcompat.app.AppCompatActivity</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>androidx.appcompat.widget.Toolbar</span><span class=p>;</span>
<span class=hll><span class=kn>import</span> <span class=nn>androidx.lifecycle.Observer</span><span class=p>;</span>
</span><span class=kn>import</span> <span class=nn>androidx.lifecycle.ViewModelProvider</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>androidx.lifecycle.ViewModelProviders</span><span class=p>;</span>
</code></pre></div></div> <input name=__tabbed_9 type=radio id=__tabbed_9_2><label for=__tabbed_9_2>Old</label><div class=tabbed-content><div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>androidx.appcompat.app.AppCompatActivity</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>androidx.appcompat.widget.Toolbar</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>androidx.lifecycle.ViewModelProvider</span><span class=p>;</span>
<span class=kn>import</span> <span class=nn>androidx.lifecycle.ViewModelProviders</span><span class=p>;</span>
</code></pre></div></div> </div> <blockquote> <p>protected void onCreate(Bundle savedInstanceState) {</p> </blockquote> <div class=tabbed-set data-tabs=10:2> <input name=__tabbed_10 type=radio id=__tabbed_10_1 checked=checked><label for=__tabbed_10_1>New</label><div class=tabbed-content><div class=highlight><pre><span></span><code>        <span class=n>laneDownCat3</span> <span class=o>=</span> <span class=n>findViewById</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>laneDownCat3</span><span class=p>);</span>
        <span class=n>trafficCounterViewModel</span> <span class=o>=</span>
                <span class=k>new</span> <span class=n>ViewModelProvider</span><span class=p>(</span><span class=k>this</span><span class=p>)</span>
<span class=hll>                        <span class=p>.</span><span class=na>get</span><span class=p>(</span><span class=n>TrafficCounterViewModel</span><span class=p>.</span><span class=na>class</span><span class=p>);</span>
</span>
<span class=hll>
</span><span class=hll>        <span class=n>trafficCounterViewModel</span><span class=p>.</span><span class=na>carDown</span><span class=p>.</span><span class=na>observe</span><span class=p>(</span><span class=k>this</span><span class=p>,</span> <span class=k>new</span> <span class=n>Observer</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span><span class=p>()</span> <span class=p>{</span>
</span><span class=hll>            <span class=nd>@Override</span>
</span><span class=hll>            <span class=kd>public</span> <span class=kt>void</span> <span class=nf>onChanged</span><span class=p>(</span><span class=n>Integer</span> <span class=n>integer</span><span class=p>)</span> <span class=p>{</span>
</span><span class=hll>                <span class=n>laneDownCat1</span><span class=p>.</span><span class=na>setText</span><span class=p>(</span><span class=n>integer</span><span class=p>.</span><span class=na>toString</span><span class=p>());</span>
</span><span class=hll>            <span class=p>}</span>
</span><span class=hll>        <span class=p>});</span>
</span><span class=hll>
</span><span class=hll>        <span class=n>trafficCounterViewModel</span><span class=p>.</span><span class=na>vanDown</span><span class=p>.</span><span class=na>observe</span><span class=p>(</span><span class=k>this</span><span class=p>,</span> <span class=k>new</span> <span class=n>Observer</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span><span class=p>()</span> <span class=p>{</span>
</span><span class=hll>            <span class=nd>@Override</span>
</span><span class=hll>            <span class=kd>public</span> <span class=kt>void</span> <span class=nf>onChanged</span><span class=p>(</span><span class=n>Integer</span> <span class=n>integer</span><span class=p>)</span> <span class=p>{</span>
</span><span class=hll>                <span class=n>laneDownCat2</span><span class=p>.</span><span class=na>setText</span><span class=p>(</span><span class=n>integer</span><span class=p>.</span><span class=na>toString</span><span class=p>());</span>
</span><span class=hll>            <span class=p>}</span>
</span><span class=hll>        <span class=p>});</span>
</span><span class=hll>
</span><span class=hll>        <span class=n>trafficCounterViewModel</span><span class=p>.</span><span class=na>truckDown</span><span class=p>.</span><span class=na>observe</span><span class=p>(</span><span class=k>this</span><span class=p>,</span>
</span><span class=hll>                <span class=k>new</span> <span class=n>Observer</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span><span class=p>()</span> <span class=p>{</span>
</span><span class=hll>                    <span class=nd>@Override</span>
</span><span class=hll>                    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>onChanged</span><span class=p>(</span><span class=n>Integer</span> <span class=n>integer</span><span class=p>)</span> <span class=p>{</span>
</span><span class=hll>                        <span class=n>laneDownCat3</span><span class=p>.</span><span class=na>setText</span><span class=p>(</span><span class=n>integer</span><span class=p>.</span><span class=na>toString</span><span class=p>());</span>
</span><span class=hll>                    <span class=p>}</span>
</span><span class=hll>                <span class=p>});</span>
</span><span class=hll>
</span><span class=hll>        <span class=n>trafficCounterViewModel</span><span class=p>.</span><span class=na>carUp</span><span class=p>.</span><span class=na>observe</span><span class=p>(</span><span class=k>this</span><span class=p>,</span> <span class=k>new</span> <span class=n>Observer</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span><span class=p>()</span> <span class=p>{</span>
</span><span class=hll>            <span class=nd>@Override</span>
</span><span class=hll>            <span class=kd>public</span> <span class=kt>void</span> <span class=nf>onChanged</span><span class=p>(</span><span class=n>Integer</span> <span class=n>integer</span><span class=p>)</span> <span class=p>{</span>
</span><span class=hll>                <span class=n>laneUpCat1</span><span class=p>.</span><span class=na>setText</span><span class=p>(</span><span class=n>integer</span><span class=p>.</span><span class=na>toString</span><span class=p>());</span>
</span><span class=hll>            <span class=p>}</span>
</span><span class=hll>        <span class=p>});</span>
</span><span class=hll>
</span><span class=hll>        <span class=n>trafficCounterViewModel</span><span class=p>.</span><span class=na>vanUp</span><span class=p>.</span><span class=na>observe</span><span class=p>(</span><span class=k>this</span><span class=p>,</span> <span class=k>new</span> <span class=n>Observer</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span><span class=p>()</span> <span class=p>{</span>
</span><span class=hll>            <span class=nd>@Override</span>
</span><span class=hll>            <span class=kd>public</span> <span class=kt>void</span> <span class=nf>onChanged</span><span class=p>(</span><span class=n>Integer</span> <span class=n>integer</span><span class=p>)</span> <span class=p>{</span>
</span><span class=hll>                <span class=n>laneUpCat2</span><span class=p>.</span><span class=na>setText</span><span class=p>(</span><span class=n>integer</span><span class=p>.</span><span class=na>toString</span><span class=p>());</span>
</span><span class=hll>            <span class=p>}</span>
</span><span class=hll>        <span class=p>});</span>
</span><span class=hll>
</span><span class=hll>        <span class=n>trafficCounterViewModel</span><span class=p>.</span><span class=na>truckUp</span><span class=p>.</span><span class=na>observe</span><span class=p>(</span><span class=k>this</span><span class=p>,</span>
</span><span class=hll>                <span class=k>new</span> <span class=n>Observer</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span><span class=p>()</span> <span class=p>{</span>
</span><span class=hll>                    <span class=nd>@Override</span>
</span><span class=hll>                    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>onChanged</span><span class=p>(</span><span class=n>Integer</span> <span class=n>integer</span><span class=p>)</span> <span class=p>{</span>
</span><span class=hll>                        <span class=n>laneUpCat3</span><span class=p>.</span><span class=na>setText</span><span class=p>(</span><span class=n>integer</span><span class=p>.</span><span class=na>toString</span><span class=p>());</span>
</span><span class=hll>                    <span class=p>}</span>
</span><span class=hll>                <span class=p>});</span>
</span>    <span class=p>}</span>
</code></pre></div></div> <input name=__tabbed_10 type=radio id=__tabbed_10_2><label for=__tabbed_10_2>Old</label><div class=tabbed-content><div class=highlight><pre><span></span><code>        <span class=n>laneDownCat3</span> <span class=o>=</span> <span class=n>findViewById</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>laneDownCat3</span><span class=p>);</span>
        <span class=n>trafficCounterViewModel</span> <span class=o>=</span>
                <span class=k>new</span> <span class=n>ViewModelProvider</span><span class=p>(</span><span class=k>this</span><span class=p>)</span>
<span class=hll>                <span class=p>.</span><span class=na>get</span><span class=p>(</span><span class=n>TrafficCounterViewModel</span><span class=p>.</span><span class=na>class</span><span class=p>);</span>
</span>
<span class=hll>        <span class=n>updateUi</span><span class=p>();</span>
</span>    <span class=p>}</span>
</code></pre></div></div> </div> <blockquote> <p>public void onBtnClick(View btn) {</p> </blockquote> <div class=tabbed-set data-tabs=11:2> <input name=__tabbed_11 type=radio id=__tabbed_11_1 checked=checked><label for=__tabbed_11_1>New</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=p>}</span>

    <span class=kd>private</span> <span class=kt>void</span> <span class=nf>updateUi</span><span class=p>()</span> <span class=p>{</span>
<span class=hll>
</span>    <span class=p>}</span>

<span class=p>}</span>
</code></pre></div></div> <input name=__tabbed_11 type=radio id=__tabbed_11_2><label for=__tabbed_11_2>Old</label><div class=tabbed-content><div class=highlight><pre><span></span><code>    <span class=p>}</span>

    <span class=kd>private</span> <span class=kt>void</span> <span class=nf>updateUi</span><span class=p>()</span> <span class=p>{</span>
<span class=hll>        <span class=n>laneDownCat1</span><span class=p>.</span><span class=na>setText</span><span class=p>(</span><span class=n>trafficCounterViewModel</span><span class=p>.</span><span class=na>carDown</span><span class=p>.</span><span class=na>toString</span><span class=p>());</span>
</span><span class=hll>        <span class=n>laneDownCat2</span><span class=p>.</span><span class=na>setText</span><span class=p>(</span><span class=n>trafficCounterViewModel</span><span class=p>.</span><span class=na>vanDown</span><span class=p>.</span><span class=na>toString</span><span class=p>());</span>
</span><span class=hll>        <span class=n>laneDownCat3</span><span class=p>.</span><span class=na>setText</span><span class=p>(</span><span class=n>trafficCounterViewModel</span><span class=p>.</span><span class=na>truckDown</span><span class=p>.</span><span class=na>toString</span><span class=p>());</span>
</span><span class=hll>
</span><span class=hll>        <span class=n>laneUpCat1</span><span class=p>.</span><span class=na>setText</span><span class=p>(</span><span class=n>trafficCounterViewModel</span><span class=p>.</span><span class=na>carUp</span><span class=p>.</span><span class=na>toString</span><span class=p>());</span>
</span><span class=hll>        <span class=n>laneUpCat2</span><span class=p>.</span><span class=na>setText</span><span class=p>(</span><span class=n>trafficCounterViewModel</span><span class=p>.</span><span class=na>vanUp</span><span class=p>.</span><span class=na>toString</span><span class=p>());</span>
</span><span class=hll>        <span class=n>laneUpCat3</span><span class=p>.</span><span class=na>setText</span><span class=p>(</span><span class=n>trafficCounterViewModel</span><span class=p>.</span><span class=na>truckUp</span><span class=p>.</span><span class=na>toString</span><span class=p>());</span>
</span>    <span class=p>}</span>

<span class=p>}</span>
</code></pre></div></div> </div> <!--end--> <!--tgen step=2.2 template='mkdocs_header_only'  --> <p><br></p> <h4 id=22-update-livedata-objects>2.2 Update LiveData objects <a href=https://github.com/hudikm/TrafficCounterDemo/commit/ec0dfe6fd95a74495af8a22a1ae217636d0a53ee/ ><img alt=ðŸ”— class=twemoji src=https://twemoji.maxcdn.com/v/latest/svg/1f517.svg title=:link:></a><a class=headerlink href=#22-update-livedata-objects title="Permanent link">&para;</a></h4> <!--end--> <!--tgen step=2.2 template='mkdocs_body_only'  --> <blockquote> <p><strong><a href=https://github.com/hudikm/TrafficCounterDemo/blob/ec0dfe6fd95a74495af8a22a1ae217636d0a53ee/app/src/main/java/sk/uniza/trafficcounterdemo/MainActivity.java>ðŸ–¹</a> app/src/main/java/sk/uniza/trafficcounterdemo/MainActivity.java</strong></p> <p>public void onBtnClick(View btn) {</p> </blockquote> <div class=tabbed-set data-tabs=12:2> <input name=__tabbed_12 type=radio id=__tabbed_12_1 checked=checked><label for=__tabbed_12_1>New</label><div class=tabbed-content><div class=highlight><pre><span></span><code>        <span class=k>switch</span> <span class=p>(</span><span class=n>btn</span><span class=p>.</span><span class=na>getId</span><span class=p>())</span> <span class=p>{</span>
            <span class=k>case</span> <span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>carDownBtn</span><span class=p>:</span>
<span class=hll>                <span class=n>Integer</span> <span class=n>carDown</span> <span class=o>=</span>
</span><span class=hll>                        <span class=n>trafficCounterViewModel</span><span class=p>.</span><span class=na>carDown</span><span class=p>.</span><span class=na>getValue</span><span class=p>();</span>
</span><span class=hll>                <span class=n>trafficCounterViewModel</span><span class=p>.</span><span class=na>carDown</span><span class=p>.</span><span class=na>setValue</span><span class=p>(</span><span class=o>++</span><span class=n>carDown</span><span class=p>);</span>
</span>                <span class=k>break</span><span class=p>;</span>
            <span class=k>case</span> <span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>vanDownBtn</span><span class=p>:</span>
<span class=hll>                <span class=n>Integer</span> <span class=n>vanDown</span> <span class=o>=</span>
</span><span class=hll>                        <span class=n>trafficCounterViewModel</span><span class=p>.</span><span class=na>vanDown</span><span class=p>.</span><span class=na>getValue</span><span class=p>();</span>
</span><span class=hll>                <span class=n>trafficCounterViewModel</span><span class=p>.</span><span class=na>vanDown</span><span class=p>.</span><span class=na>setValue</span><span class=p>(</span><span class=o>++</span><span class=n>vanDown</span><span class=p>);</span>
</span>                <span class=k>break</span><span class=p>;</span>
            <span class=k>case</span> <span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>truckDownBtn</span><span class=p>:</span>
<span class=hll>                <span class=n>Integer</span> <span class=n>truckDown</span> <span class=o>=</span>
</span><span class=hll>                        <span class=n>trafficCounterViewModel</span><span class=p>.</span><span class=na>truckDown</span><span class=p>.</span><span class=na>getValue</span><span class=p>();</span>
</span><span class=hll>                <span class=n>trafficCounterViewModel</span><span class=p>.</span><span class=na>truckDown</span><span class=p>.</span><span class=na>setValue</span><span class=p>(</span><span class=o>++</span><span class=n>truckDown</span><span class=p>);</span>
</span>                <span class=k>break</span><span class=p>;</span>
            <span class=k>case</span> <span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>carUpBtn</span><span class=p>:</span>
<span class=hll>                <span class=n>Integer</span> <span class=n>carUp</span> <span class=o>=</span>
</span><span class=hll>                        <span class=n>trafficCounterViewModel</span><span class=p>.</span><span class=na>carUp</span><span class=p>.</span><span class=na>getValue</span><span class=p>();</span>
</span><span class=hll>                <span class=n>trafficCounterViewModel</span><span class=p>.</span><span class=na>carUp</span><span class=p>.</span><span class=na>setValue</span><span class=p>(</span><span class=o>++</span><span class=n>carUp</span><span class=p>);</span>
</span>                <span class=k>break</span><span class=p>;</span>
            <span class=k>case</span> <span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>vanUpBtn</span><span class=p>:</span>
<span class=hll>                <span class=n>Integer</span> <span class=n>vanUp</span> <span class=o>=</span>
</span><span class=hll>                        <span class=n>trafficCounterViewModel</span><span class=p>.</span><span class=na>vanUp</span><span class=p>.</span><span class=na>getValue</span><span class=p>();</span>
</span><span class=hll>                <span class=n>trafficCounterViewModel</span><span class=p>.</span><span class=na>vanUp</span><span class=p>.</span><span class=na>setValue</span><span class=p>(</span><span class=o>++</span><span class=n>vanUp</span><span class=p>);</span>
</span>                <span class=k>break</span><span class=p>;</span>
            <span class=k>case</span> <span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>truckUpBtn</span><span class=p>:</span>
<span class=hll>                <span class=n>Integer</span> <span class=n>truckUp</span> <span class=o>=</span>
</span><span class=hll>                        <span class=n>trafficCounterViewModel</span><span class=p>.</span><span class=na>truckUp</span><span class=p>.</span><span class=na>getValue</span><span class=p>();</span>
</span><span class=hll>                <span class=n>trafficCounterViewModel</span><span class=p>.</span><span class=na>truckUp</span><span class=p>.</span><span class=na>setValue</span><span class=p>(</span><span class=o>++</span><span class=n>truckUp</span><span class=p>);</span>
</span>                <span class=k>break</span><span class=p>;</span>
        <span class=p>}</span>
<span class=hll>        <span class=c1>// Remove this line: updateUi();</span>
</span>    <span class=p>}</span>

    <span class=kd>private</span> <span class=kt>void</span> <span class=nf>updateUi</span><span class=p>()</span> <span class=p>{</span>
</code></pre></div></div> <input name=__tabbed_12 type=radio id=__tabbed_12_2><label for=__tabbed_12_2>Old</label><div class=tabbed-content><div class=highlight><pre><span></span><code>        <span class=k>switch</span> <span class=p>(</span><span class=n>btn</span><span class=p>.</span><span class=na>getId</span><span class=p>())</span> <span class=p>{</span>
            <span class=k>case</span> <span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>carDownBtn</span><span class=p>:</span>
<span class=hll>                <span class=n>trafficCounterViewModel</span><span class=p>.</span><span class=na>carDown</span><span class=o>++</span><span class=p>;</span>
</span>                <span class=k>break</span><span class=p>;</span>
            <span class=k>case</span> <span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>vanDownBtn</span><span class=p>:</span>
<span class=hll>                <span class=n>trafficCounterViewModel</span><span class=p>.</span><span class=na>vanDown</span><span class=o>++</span><span class=p>;</span>
</span>                <span class=k>break</span><span class=p>;</span>
            <span class=k>case</span> <span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>truckDownBtn</span><span class=p>:</span>
<span class=hll>                <span class=n>trafficCounterViewModel</span><span class=p>.</span><span class=na>truckDown</span><span class=o>++</span><span class=p>;</span>
</span>                <span class=k>break</span><span class=p>;</span>
            <span class=k>case</span> <span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>carUpBtn</span><span class=p>:</span>
<span class=hll>                <span class=n>trafficCounterViewModel</span><span class=p>.</span><span class=na>carUp</span><span class=o>++</span><span class=p>;</span>
</span>                <span class=k>break</span><span class=p>;</span>
            <span class=k>case</span> <span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>vanUpBtn</span><span class=p>:</span>
<span class=hll>                <span class=n>trafficCounterViewModel</span><span class=p>.</span><span class=na>vanUp</span><span class=o>++</span><span class=p>;</span>
</span>                <span class=k>break</span><span class=p>;</span>
            <span class=k>case</span> <span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>truckUpBtn</span><span class=p>:</span>
<span class=hll>                <span class=n>trafficCounterViewModel</span><span class=p>.</span><span class=na>truckUp</span><span class=o>++</span><span class=p>;</span>
</span>                <span class=k>break</span><span class=p>;</span>
        <span class=p>}</span>
<span class=hll>        <span class=n>updateUi</span><span class=p>();</span>
</span>    <span class=p>}</span>

    <span class=kd>private</span> <span class=kt>void</span> <span class=nf>updateUi</span><span class=p>()</span> <span class=p>{</span>
</code></pre></div></div> </div> <!--end--> <p>At this point the basic application is finished and you can test it. </p> <!--end--> <div id=disqus_thread></div> <script>
/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://trafficcounterdemo.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script> <noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript> </article> </div> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Copyright &copy; 2020 Martin HÃºdik </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-footer-social> <a href=https://github.com/squidfunk target=_blank rel=noopener title=github.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> </div> </div> </div> </footer> </div> <script src=assets/javascripts/vendor.83fe6e3c.min.js></script> <script src=assets/javascripts/bundle.7e1cb91c.min.js></script><script id=__lang type=application/json>{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script> <script>
        app = initialize({
          base: ".",
          features: ["tabs"],
          search: Object.assign({
            worker: "assets/javascripts/worker/search.37585f48.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script> </body> </html>